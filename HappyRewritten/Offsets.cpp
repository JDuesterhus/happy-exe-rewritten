#include "Offsets.h"

COffsets Offsets;

void COffsets::DownloadOffsets() {
	char downloadUrl[256] = "https://raw.githubusercontent.com/frk1/hazedumper/master/csgo.toml";
	char downloadFileName[64] = ".\\offsets.ini";
	//URLDownloadToFile(0, downloadUrl, downloadFileName, 0, 0);
	//DeleteUrlCacheEntry(downloadUrl);
	CIniReader iniReader(downloadFileName);

	clientstate_choked_commands = iniReader.ReadInteger("signatures", "clientstate_choked_commands", 19752);
	clientstate_delta_ticks = iniReader.ReadInteger("signatures", "clientstate_delta_ticks", 372);
	clientstate_last_outgoing_command = iniReader.ReadInteger("signatures", "clientstate_last_outgoing_command", 19748);
	clientstate_net_channel = iniReader.ReadInteger("signatures", "clientstate_net_channel", 156);
	convar_name_hash_table = iniReader.ReadInteger("signatures", "convar_name_hash_table", 192760);
	dwClientState = iniReader.ReadInteger("signatures", "dwClientState", 5815548);
	dwClientState_GetLocalPlayer = iniReader.ReadInteger("signatures", "dwClientState_GetLocalPlayer", 384);
	dwClientState_IsHLTV = iniReader.ReadInteger("signatures", "dwClientState_IsHLTV", 19776);
	dwClientState_Map = iniReader.ReadInteger("signatures", "dwClientState_Map", 652);
	dwClientState_MapDirectory = iniReader.ReadInteger("signatures", "dwClientState_MapDirectory", 392);
	dwClientState_MaxPlayer = iniReader.ReadInteger("signatures", "dwClientState_MaxPlayer", 904);
	dwClientState_PlayerInfo = iniReader.ReadInteger("signatures", "dwClientState_PlayerInfo", 21176);
	dwClientState_State = iniReader.ReadInteger("signatures", "dwClientState_State", 264);
	dwClientState_ViewAngles = iniReader.ReadInteger("signatures", "dwClientState_ViewAngles", 19848);
	dwEntityList = iniReader.ReadInteger("signatures", "dwEntityList", 80622844);
	dwForceAttack = iniReader.ReadInteger("signatures", "dwForceAttack", 51465156);
	dwForceAttack2 = dwForceAttack * 2 - iniReader.ReadInteger("signatures", "dwForceAttack2", 51465168); //temp fix because hazedumper gives wrong address
	dwForceBackward = iniReader.ReadInteger("signatures", "dwForceBackward", 51465240);
	dwForceForward = iniReader.ReadInteger("signatures", "dwForceForward", 51465204);
	dwForceJump = iniReader.ReadInteger("signatures", "dwForceJump", 85485976);
	dwForceLeft = iniReader.ReadInteger("signatures", "dwForceLeft", 51465228);
	dwForceRight = iniReader.ReadInteger("signatures", "dwForceRight", 51465264);
	dwGameDir = iniReader.ReadInteger("signatures", "dwGameDir", 6496112);
	dwGameRulesProxy = iniReader.ReadInteger("signatures", "dwGameRulesProxy", 85953748);
	dwGetAllClasses = iniReader.ReadInteger("signatures", "dwGetAllClasses", 13593540);
	dwGlobalVars = iniReader.ReadInteger("signatures", "dwGlobalVars", 5814784);
	dwGlowObjectManager = iniReader.ReadInteger("signatures", "dwGlowObjectManager", 86128448);
	dwInput = iniReader.ReadInteger("signatures", "dwInput", 85124368);
	dwInterfaceLinkList = iniReader.ReadInteger("signatures", "dwInterfaceLinkList", 9109316);
	dwLocalPlayer = iniReader.ReadInteger("signatures", "dwLocalPlayer", 13444964);
	dwMouseEnable = iniReader.ReadInteger("signatures", "dwMouseEnable", 13468336);
	dwMouseEnablePtr = iniReader.ReadInteger("signatures", "dwMouseEnablePtr", 13468288);
	dwPlayerResource = iniReader.ReadInteger("signatures", "dwPlayerResource", 51457884);
	dwRadarBase = iniReader.ReadInteger("signatures", "dwRadarBase", 85033532);
	dwSensitivity = iniReader.ReadInteger("signatures", "dwSensitivity", 13467980);
	dwSensitivityPtr = iniReader.ReadInteger("signatures", "dwSensitivityPtr", 13467936);
	dwSetClanTag = iniReader.ReadInteger("signatures", "dwSetClanTag", 562848);
	dwViewMatrix = iniReader.ReadInteger("signatures", "dwViewMatrix", 80563988);
	dwWeaponTable = iniReader.ReadInteger("signatures", "dwWeaponTable", 85127128);
	dwWeaponTableIndex = iniReader.ReadInteger("signatures", "dwWeaponTableIndex", 12860);
	dwYawPtr = iniReader.ReadInteger("signatures", "dwYawPtr", 13467408);
	dwZoomSensitivityRatioPtr = iniReader.ReadInteger("signatures", "dwZoomSensitivityRatioPtr", 13488464);
	dwbSendPackets = iniReader.ReadInteger("signatures", "dwbSendPackets", 861242);
	dwppDirect3DDevice9 = iniReader.ReadInteger("signatures", "dwppDirect3DDevice9", 679968);
	force_update_spectator_glow = iniReader.ReadInteger("signatures", "force_update_spectator_glow", 3726978);
	interface_engine_cvar = iniReader.ReadInteger("signatures", "interface_engine_cvar", 256492);
	is_c4_owner = iniReader.ReadInteger("signatures", "is_c4_owner", 3776352);
	m_bDormant = iniReader.ReadInteger("signatures", "m_bDormant", 237);
	m_pStudioHdr = iniReader.ReadInteger("signatures", "m_pStudioHdr", 10572);
	m_pitchClassPtr = iniReader.ReadInteger("signatures", "m_pitchClassPtr", 85034224);
	m_yawClassPtr = iniReader.ReadInteger("signatures", "m_yawClassPtr", 13467408);
	model_ambient_min = iniReader.ReadInteger("signatures", "model_ambient_min", 5827868);
	set_abs_angles = iniReader.ReadInteger("signatures", "set_abs_angles", 1866864);
	set_abs_origin = iniReader.ReadInteger("signatures", "set_abs_origin", 1866416);

	cs_gamerules_data = iniReader.ReadInteger("netvars", "cs_gamerules_data", 0);
	m_ArmorValue = iniReader.ReadInteger("netvars", "m_ArmorValue", 45864);
	m_Collision = iniReader.ReadInteger("netvars", "m_Collision", 796);
	m_CollisionGroup = iniReader.ReadInteger("netvars", "m_CollisionGroup", 1140);
	m_Local = iniReader.ReadInteger("netvars", "m_Local", 12220);
	m_MoveType = iniReader.ReadInteger("netvars", "m_MoveType", 604);
	m_OriginalOwnerXuidHigh = iniReader.ReadInteger("netvars", "m_OriginalOwnerXuidHigh", 12724);
	m_OriginalOwnerXuidLow = iniReader.ReadInteger("netvars", "m_OriginalOwnerXuidLow", 12720);
	m_SurvivalGameRuleDecisionTypes = iniReader.ReadInteger("netvars", "m_SurvivalGameRuleDecisionTypes", 4888);
	m_SurvivalRules = iniReader.ReadInteger("netvars", "m_SurvivalRules", 3312);
	m_aimPunchAngle = iniReader.ReadInteger("netvars", "m_aimPunchAngle", 12332);
	m_aimPunchAngleVel = iniReader.ReadInteger("netvars", "m_aimPunchAngleVel", 12344);
	m_angEyeAnglesX = iniReader.ReadInteger("netvars", "m_angEyeAnglesX", 45868);
	m_angEyeAnglesY = iniReader.ReadInteger("netvars", "m_angEyeAnglesY", 45872);
	m_bBombPlanted = iniReader.ReadInteger("netvars", "m_bBombPlanted", 2461);
	m_bFreezePeriod = iniReader.ReadInteger("netvars", "m_bFreezePeriod", 32);
	m_bGunGameImmunity = iniReader.ReadInteger("netvars", "m_bGunGameImmunity", 14632);
	m_bHasDefuser = iniReader.ReadInteger("netvars", "m_bHasDefuser", 45880);
	m_bHasHelmet = iniReader.ReadInteger("netvars", "m_bHasHelmet", 45852);
	m_bInReload = iniReader.ReadInteger("netvars", "m_bInReload", 12933);
	m_bIsDefusing = iniReader.ReadInteger("netvars", "m_bIsDefusing", 14612);
	m_bIsGrabbingHostage = m_bIsDefusing + 0x1; //not in hazedumper
	m_bIsQueuedMatchmaking = iniReader.ReadInteger("netvars", "m_bIsQueuedMatchmaking", 116);
	m_bIsScoped = iniReader.ReadInteger("netvars", "m_bIsScoped", 14602);
	m_bIsValveDS = iniReader.ReadInteger("netvars", "m_bIsValveDS", 117);
	m_bSpotted = iniReader.ReadInteger("netvars", "m_bSpotted", 2365);
	m_bSpottedByMask = iniReader.ReadInteger("netvars", "m_bSpottedByMask", 2432);
	m_clrRender = iniReader.ReadInteger("netvars", "m_clrRender", 112);
	m_dwBoneMatrix = iniReader.ReadInteger("netvars", "m_dwBoneMatrix", 9896);
	m_fAccuracyPenalty = iniReader.ReadInteger("netvars", "m_fAccuracyPenalty", 13060);
	m_fFlags = iniReader.ReadInteger("netvars", "m_fFlags", 260);
	m_flC4Blow = iniReader.ReadInteger("netvars", "m_flC4Blow", 10640);
	m_flDefuseCountDown = iniReader.ReadInteger("netvars", "m_flDefuseCountDown", 10668);
	m_flDefuseLength = iniReader.ReadInteger("netvars", "m_flDefuseLength", 10664);
	m_flFallbackWear = iniReader.ReadInteger("netvars", "m_flFallbackWear", 12736);
	m_flFlashDuration = iniReader.ReadInteger("netvars", "m_flFlashDuration", 41952);
	m_flFlashMaxAlpha = iniReader.ReadInteger("netvars", "m_flFlashMaxAlpha", 41948);
	m_flLastBoneSetupTime = iniReader.ReadInteger("netvars", "m_flLastBoneSetupTime", 10532);
	m_flLowerBodyYawTarget = iniReader.ReadInteger("netvars", "m_flLowerBodyYawTarget", 14964);
	m_flNextAttack = iniReader.ReadInteger("netvars", "m_flNextAttack", 11632);
	m_flNextPrimaryAttack = iniReader.ReadInteger("netvars", "m_flNextPrimaryAttack", 12824);
	m_flSimulationTime = iniReader.ReadInteger("netvars", "m_flSimulationTime", 616);
	m_flTimerLength = iniReader.ReadInteger("netvars", "m_flTimerLength", 10644);
	m_hActiveWeapon = iniReader.ReadInteger("netvars", "m_hActiveWeapon", 12024);
	m_hMyWeapons = iniReader.ReadInteger("netvars", "m_hMyWeapons", 11768);
	m_hObserverTarget = iniReader.ReadInteger("netvars", "m_hObserverTarget", 13192);
	m_hOwner = iniReader.ReadInteger("netvars", "m_hOwner", 10700);
	m_hOwnerEntity = iniReader.ReadInteger("netvars", "m_hOwnerEntity", 332);
	m_iAccountID = iniReader.ReadInteger("netvars", "m_iAccountID", 12232);
	m_iClip1 = iniReader.ReadInteger("netvars", "m_iClip1", 12868);
	m_iCompetitiveRanking = iniReader.ReadInteger("netvars", "m_iCompetitiveRanking", 6788);
	m_iCompetitiveWins = iniReader.ReadInteger("netvars", "m_iCompetitiveWins", 7048);
	m_iCrosshairId = iniReader.ReadInteger("netvars", "m_iCrosshairId", 45972);
	m_iEntityQuality = iniReader.ReadInteger("netvars", "m_iEntityQuality", 12204);
	m_iFOV = iniReader.ReadInteger("netvars", "m_iFOV", 12772);
	m_iFOVStart = iniReader.ReadInteger("netvars", "m_iFOVStart", 12776);
	m_iGlowIndex = iniReader.ReadInteger("netvars", "m_iGlowIndex", 41976);
	m_iHealth = iniReader.ReadInteger("netvars", "m_iHealth", 256);
	m_iItemDefinitionIndex = iniReader.ReadInteger("netvars", "m_iItemDefinitionIndex", 12202);
	m_iItemIDHigh = iniReader.ReadInteger("netvars", "m_iItemIDHigh", 12224);
	m_iMostRecentModelBoneCounter = iniReader.ReadInteger("netvars", "m_iMostRecentModelBoneCounter", 9872);
	m_iObserverMode = iniReader.ReadInteger("netvars", "m_iObserverMode", 13172);
	m_iShotsFired = iniReader.ReadInteger("netvars", "m_iShotsFired", 41840);
	m_iState = iniReader.ReadInteger("netvars", "m_iState", 12856);
	m_iTeamNum = iniReader.ReadInteger("netvars", "m_iTeamNum", 244);
	m_lifeState = iniReader.ReadInteger("netvars", "m_lifeState", 607);
	m_nFallbackPaintKit = iniReader.ReadInteger("netvars", "m_nFallbackPaintKit", 12728);
	m_nFallbackSeed = iniReader.ReadInteger("netvars", "m_nFallbackSeed", 12732);
	m_nFallbackStatTrak = iniReader.ReadInteger("netvars", "m_nFallbackStatTrak", 12740);
	m_nForceBone = iniReader.ReadInteger("netvars", "m_nForceBone", 9868);
	m_nTickBase = iniReader.ReadInteger("netvars", "m_nTickBase", 13356);
	m_rgflCoordinateFrame = iniReader.ReadInteger("netvars", "m_rgflCoordinateFrame", 1092);
	m_szCustomName = iniReader.ReadInteger("netvars", "m_szCustomName", 12348);
	m_szLastPlaceName = iniReader.ReadInteger("netvars", "m_szLastPlaceName", 13744);
	m_thirdPersonViewAngles = iniReader.ReadInteger("netvars", "m_thirdPersonViewAngles", 12760);
	m_vecOrigin = iniReader.ReadInteger("netvars", "m_vecOrigin", 312);
	m_vecVelocity = iniReader.ReadInteger("netvars", "m_vecVelocity", 276);
	m_vecViewOffset = iniReader.ReadInteger("netvars", "m_vecViewOffset", 264);
	m_viewPunchAngle = iniReader.ReadInteger("netvars", "m_viewPunchAngle", 12320);
}